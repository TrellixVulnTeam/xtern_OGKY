diff -ruN gcc-4.5.4-orig/libgomp/config/posix/bar.c gcc-4.5.4/libgomp/config/posix/bar.c
--- gcc-4.5.4-orig/libgomp/config/posix/bar.c	2012-12-26 01:03:55.935889276 -0500
+++ gcc-4.5.4/libgomp/config/posix/bar.c	2012-12-27 02:08:28.308659301 -0500
@@ -28,7 +28,7 @@
    POSIX pthread_barrier_t won't work.  */
 
 #include "libgomp.h"
-
+#include "tern/user.h"
 
 void
 gomp_barrier_init (gomp_barrier_t *bar, unsigned count)
@@ -42,6 +42,7 @@
   bar->total = count;
   bar->arrived = 0;
   bar->generation = 0;
+  tern_lineup_init((long)bar, count, 100);
 }
 
 void
@@ -106,6 +107,8 @@
 gomp_barrier_wait (gomp_barrier_t *barrier)
 {
   gomp_barrier_wait_end (barrier, gomp_barrier_wait_start (barrier));
+  tern_lineup_start((long)barrier);
+  tern_lineup_end((long)barrier);
 }
 
 void
@@ -166,6 +169,8 @@
 gomp_team_barrier_wait (gomp_barrier_t *barrier)
 {
   gomp_team_barrier_wait_end (barrier, gomp_barrier_wait_start (barrier));
+  tern_lineup_start((long)barrier);
+  tern_lineup_end((long)barrier);
 }
 
 void
